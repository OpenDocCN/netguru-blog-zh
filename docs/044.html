<html>
<head>
<title>How to Set up an Automatic Docker Staging - Mini Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何设置自动Docker暂存-迷你指南</h1>
<blockquote>原文：<a href="http://web.archive.org/web/20230307163032/https://www.netguru.com/blog/automatic-docker-staging#0001-01-01">http://web.archive.org/web/20230307163032/https://www.netguru.com/blog/automatic-docker-staging#0001-01-01</a></blockquote><div><div id="hs_cos_wrapper_post_body"><span><div class="blog-post__lead h3"><p>动态分段或集成使用Docker和Docker Compose的组合功能，Docker Compose是一个工具，它让您可以轻松地配置和链接具有单个YAML文件的容器，以及构建具有链接服务(如数据库、redis等)的容器。看看如何设置自动Docker staging，以及我们在Netguru上是如何做的。</p></div><h2>Netguru是怎么运作的？</h2>
<p>每次创建拉请求时，GitHub都会向我们专门创建的应用程序Heaven发送一个webhook，该应用程序会获取特定分支的最新Git版本以及拉请求编号，并使用所述Docker Compose配置“构建”应用程序，该配置稍后可由在<span> docker-compose.yml. </span>中指定的主机访问</p>
<p>Docker编写器配置示例可能如下所示:</p>
<p data-gist-id="62b79fd5ddd321b2a03e3527786ac854">[代码]</p>
<p>我们在第2行定义了应该构建什么，并在第3行提供了Dockerfile。</p>
<p>我们有一个链接部分，它链接了第12行和第14行的容器，这些容器构建在给定的图像上，以后可以从我们的“主”应用程序容器中访问。我们可以很容易地为我们的容器和其他选项设置环境变量，例如<span> cpu_quota </span>或<span>主机名</span>。</p>
<p>只要我们的pull请求被打开，每个对PR的新提交都会用新代码重新构建容器，所以当我们访问我们在配置文件的第8行提供的主机时，我们应该看到我们的“动态”设置应用程序。</p>
<p>当使用拉请求开发应用程序时，每个票据都有自己的分支，这意味着每个票据都有自己的拉请求。这使我们能够测试仅在我们的票证范围内的更改，并且我们不必担心其他人的更改可能会破坏应用程序。它也有一个缺点——一方面，每个动态staging都有自己的数据库容器，我们可以破坏它，但是——另一方面，正常和动态<span> staging </span>之间的数据没有链接，这意味着我们必须为我们需要的初始数据库状态指定种子。</p>
<p>你认为这个解决方案怎么样？请在下面的评论中告诉我！</p></span></div></div>    
</body>
</html>