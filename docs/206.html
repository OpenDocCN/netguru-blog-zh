<html>
<head>
<title>Ember: Adding Catch Block for Returned Promise</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Ember:为返回的承诺添加Catch块</h1>
<blockquote>原文：<a href="http://web.archive.org/web/20230307163032/https://www.netguru.com/blog/ember-adding-catch-block-for-returned-promise#0001-01-01">http://web.archive.org/web/20230307163032/https://www.netguru.com/blog/ember-adding-catch-block-for-returned-promise#0001-01-01</a></blockquote><div><span><div class="blog-post__lead h2"><p>承诺是JS开发者工具箱中的一个有价值的工具。在他们的帮助下，我们可以避免回调地狱，并编写一些结构优美的代码。但是承诺可能非常棘手...</p></div><p> </p>
<p><span>我是<a href="http://web.archive.org/web/20221007195506/https://www.netguru.com/services/vue-js-development">一个Ember </a>人，我使用Ember提供的promise实现，它符合ES6定义。最近，我忘记了承诺的一个特点，在随之而来的困难中，我学到了一些新的东西，我想与你分享。</span></p>
<h2>余烬遇上API</h2>
<p>假设您想使用模型钩子中的Ember数据从API获取一些数据:</p>
<p data-gist-id="2405709e1becefd27809"> </p>
<p>但是你认为这有风险。您的后端人员遇到了一些问题，有时服务器在该端点没有响应。在他们修复它之前，这个模型钩子的错误会让你的应用程序陷入错误的轨道。你想确保这不会发生。</p>
<p data-gist-id="f31901c30971547e672e"> </p>
<p><span>答对了！当服务器关闭时，用户被重定向到另一个路由。但是，你刚刚弄坏了app...当服务器启动时，您的<code>setupController</code>操作将获得一个<code>undefined</code>模型。为什么？</span></p>
<h2>应对承诺中的诡计</h2>
<p>好的，我知道承诺是可以链接的，所以我使用了上面的方法。然而，我忘记了<code>catch</code>和<code>then</code>也是可链接的，它们返回promise类的<strong>新</strong>实例，该实例将解析为您从<code>then</code>或<code>catch</code>返回的值。我们所做的是转换但不返回任何东西，所以<code>model</code>钩子基本上是返回<code>undefined</code>。</p>
<p>我们被困住了吗？不，这种情况有一个简单易行的解决方法:</p>
<p data-gist-id="ab567c2be928639432e6"> </p>
<p>如您所见，我们从<code>store</code>返回了初始的promise对象，并在完全不同的代码行中链接了该承诺。我们不使用链式方法返回的值，现在一切都正常了！</p>
<p>我希望你觉得这个案例很有趣。在Emberjs工作期间还遇到过其他有趣的许诺情况吗？请在评论中告诉我！</p>
<p> </p>
<p class="p1">如果余烬是你感兴趣的领域之一，我有一些有趣的读物给你: </p>
<p class="p1"><a href="http://web.archive.org/web/20221007195506/https://www.netguru.com/blog/emberjs-resources" target="_blank" rel="noopener"> <span class="s1"> 11 Ember.js资源你一定要去看看</span> </a></p>
<p class="p1"><a href="http://web.archive.org/web/20221007195506/https://www.netguru.com/blog/active-model-serializers-ember" target="_blank" rel="noopener"><span class="s1">active model::serializer能为Ember数据API做什么</span> </a></p></span></div>    
</body>
</html>