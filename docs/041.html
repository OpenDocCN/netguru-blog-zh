<html>
<head>
<title>Clean Swift iOS Architectural Design with SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>ä½¿ç”¨SwiftUIæ¸…æ´Swift iOSæ¶æ„è®¾è®¡</h1>
<blockquote>åŸæ–‡ï¼š<a href="http://web.archive.org/web/20230307163032/https://www.netguru.com/blog/clean-swift-with-swiftui-ios#0001-01-01">http://web.archive.org/web/20230307163032/https://www.netguru.com/blog/clean-swift-with-swiftui-ios#0001-01-01</a></blockquote><div><div id="hs_cos_wrapper_post_body"><span><div class="blog-post__lead h3"><p>è‡ª2019å¹´9æœˆSwiftUIæ¡†æ¶å‘å¸ƒä»¥æ¥ï¼Œå¤§å¤šæ•°iOSåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜è¦ä¹ˆç­‰å¾…å…¶ä»–äººæ‰¾å‡ºä¸€ç§ä»¥å¹²å‡€çš„æ–¹å¼ä½¿ç”¨æ–°UIåº“çš„æ–¹æ³•ï¼Œè¦ä¹ˆè‡ªå·±å°è¯•ã€‚</p></div><p>åœ¨è¿™é‡Œï¼Œæˆ‘æƒ³åˆ†äº«ä¸€ä¸‹æˆ‘ä¸ºè‡ªå·±ä»äº‹çš„å•†ä¸šé¡¹ç›®å‡†å¤‡çš„æ–¹æ³•ã€‚æˆ‘æƒ³<span data-style-font-weight-bold="">ç»§ç»­UIKit </span>ä¸­åº”ç”¨çš„å¯¼èˆªæµç¨‹ï¼Œç”¨å¹²å‡€çš„Swift cleanæ¶æ„ä¿æŒä¸šåŠ¡é€»è¾‘çš„é«˜å¯æµ‹è¯•æ€§ï¼Œè€Œ<span data-style-font-weight-bold="">å°è¯•ç”¨SwiftUI </span>å®ç°è§†å›¾ã€‚</p>
<h2>ä¸ºä»€ä¹ˆä¸æ”¹ç”¨çº¯SwiftUIï¼Ÿ</h2>
<p>æˆ‘åœ¨Swiftä¸­çœ‹åˆ°å¾ˆå¤šReduxã€MVVMç­‰çŸ¥åçš„UIæ¶æ„çš„æ¶æ„è®¾è®¡æ¨¡å¼çš„ç«¯å£ä¸SwiftUIä¸€èµ·ä½¿ç”¨ã€‚ç„¶è€Œï¼Œä»–ä»¬éƒ½æ²¡æœ‰è¯´æœæˆ‘ï¼Œå®ƒå¯ä»¥ç”¨åœ¨ä¸€ä¸ªç›¸å½“æ—§çš„é¡¹ç›®ä¸­ï¼Œä¸¥é‡ä¾èµ–äºObjective-Cä¸­çš„æ—§ç»„ä»¶(singletonså’Œmanagers ),æœ€é‡è¦çš„æ˜¯,<span data-style-font-weight-bold="">ä»ç„¶éœ€è¦ä»æˆ‘ä»¬æ·»åŠ çš„æ–°åœºæ™¯ä¸­æ¨é€æˆ–æ˜¾ç¤ºç”¨UIKit </span>ç¼–å†™çš„æ—§è§†å›¾æ§åˆ¶å™¨ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘è¯•å›¾ä¿æŒé¡¹ç›®åœ¨ä¸šåŠ¡é€»è¾‘åˆ†ç¦»çš„æƒ…å†µä¸‹æ˜¯å¯æµ‹è¯•çš„ï¼Œä¸åˆ‡æ¢åˆ°pure SwiftUIçš„å¦ä¸€ä¸ªé‡è¦åŸå› æ˜¯Clean Swiftå·²ç»è¢«ç”¨ä½œæ‰€æœ‰ç°ä»£æ¨¡å—çš„ä¸»è¦æ¨¡å¼ã€‚</p>
<p>å¦‚æœä½ æƒ³çŸ¥é“<span data-style-font-weight-bold=""> Clean Swiftæ¶æ„è®¾è®¡æ¨¡å¼</span>æ˜¯ä»€ä¹ˆï¼Œ<a href="/web/20221111121043/https://www.netguru.com/blog/clean-swift-ios-architecture-pattern#:~:text=Clean%20Swift%20(VIP)%20was%20first,in%20Uncle%20Bob'sClean%20Architecture." rel="noopener" target="_blank">åœ¨é˜…è¯»è¿™ç¯‡æ–‡ç« ä¹‹å‰å…ˆçœ‹çœ‹æˆ‘ä»¥å‰çš„æ–‡ç« </a>ã€‚</p>
<h2>æœ‰å“ªäº›å˜åŒ–ï¼Ÿ</h2>
<p>å°†SwiftUIä¸Clean Swift  <span>ä¸€èµ·ä½¿ç”¨<span data-style-font-weight-bold="">éœ€è¦åšçš„ä¸»è¦æ”¹å˜æ˜¯</span> <span data-style-font-weight-bold=""> : </span></span></p>
<ul>
<li>
<p><em> SceneViewController </em>å°†ä¿å­˜ä¸€ä¸ªå¯¹<em> SceneViewModel </em>çš„å¼•ç”¨ï¼Œå®ƒæ˜¯æˆ‘ä»¬<em>è§†å›¾çš„æ•°æ®ã€çŠ¶æ€å’Œä»£è¡¨çš„æ¥æºã€‚</em></p>
<pre>protocol WelcomeSceneViewControllerInput: AnyObject {
    var router: WelcomeSceneRoutingLogic? { get set }
    var viewModel: WelcomeSceneViewModel? { get set }
}
</pre>
</li>
<li><em> SceneViewModel </em>æ˜¯ä¸€ä¸ªæ–°ç±»ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Combineä½¿SwiftUIçš„è§†å›¾å…·æœ‰ååº”æ€§ã€‚<br/> <pre>protocol WelcomeSceneViewDelegate: AnyObject {     func didSelectButton(_ sender: WelcomeSceneViewModel?) }  protocol WelcomeSceneViewModel {     var delegate: WelcomeSceneViewDelegate? { get set }     var text: String { get }     var buttonText: String { get } }  final class DefaultWelcomeSceneViewModel: WelcomeSceneViewModel {     var delegate: WelcomeSceneViewDelegate?     @Published private(set) var text: String     @Published private(set) var buttonText: String          init(         text: String,         buttonText: String     ) {         self.text = text         self.buttonText = buttonText     } } </pre></li>
<li><em>åœºæ™¯è§†å›¾æ§åˆ¶å™¨</em>ç»§æ‰¿è‡ª<em> UIHostingController &lt;åœºæ™¯è§†å›¾&gt; </em>ï¼Œè€Œä¸æ˜¯ç»§æ‰¿è‡ªUIViewControllerã€‚<br/> <pre>final class WelcomeSceneViewController: UIHostingController {     var interactor: WelcomeSceneViewControllerOutput?     var router: WelcomeSceneRoutingLogic?     var viewModel: WelcomeSceneViewModel? } </pre>åœ¨è¿™é‡ŒæŸ¥çœ‹æˆ‘çš„ç¤ºä¾‹é¡¹ç›®<a href="http://web.archive.org/web/20221111121043/http://welcomesceneviewcontroller.swift/" rel="noopener" target="_blank">ä¸­çš„ä½¿ç”¨ç¤ºä¾‹ã€‚</a></li>
<li><em>åœºæ™¯é…ç½®å™¨</em>è·å–<em>è§†å›¾æ¨¡å‹</em>å¹¶å°†å…¶åˆ†é…ç»™<em>è§†å›¾æ§åˆ¶å™¨ã€‚<br/> </em>å°†æ–¹æ³•'é…ç½®å¥½(...)'åŒ…å«äº†è®¸å¤šæ ·æ¿ä»£ç ï¼Œä½†åªè¦æ‚¨ä½¿ç”¨æœ¬æŠ¥å‘Šä¸­çš„<a href="http://web.archive.org/web/20221111121043/https://github.com/strzempa/CleanSwiftWithSwiftUI/tree/main/XcodeTemplates/CleanSwift%20%2B%20SwiftUI" rel="noopener" target="_blank">æˆ‘çš„ä»£ç æ¨¡æ¿å’Œä¸ºé…ç½®å™¨æ¨¡å—æä¾›çš„æµ‹è¯•ç”¨ä¾‹ï¼Œè¿™åº”è¯¥ä¸æ˜¯é—®é¢˜ã€‚<em> <br/> </em> <pre>protocol WelcomeSceneConfigurator {     func configured(         with viewModel: WelcomeSceneViewModel     ) -&gt; WelcomeSceneViewController }  final class DefaultWelcomeSceneConfigurator: WelcomeSceneConfigurator {     func configured(         with viewModel: WelcomeSceneViewModel     ) -&gt; WelcomeSceneViewController {<br/>        var viewModel = viewModel         let viewController = WelcomeSceneViewController(             rootView: WelcomeSceneView(viewModel: viewModel)         )         let interactor = WelcomeSceneInteractor()         let presenter = WelcomeScenePresenter()         let router = WelcomeSceneRouter()         router.source = viewController         presenter.viewController = viewController         interactor.presenter = presenter         viewController.interactor = interactor         viewController.router = router         viewController.viewModel = viewModel         viewModel.delegate = viewController         return viewController     } } </pre></a></li>
<li>æˆ‘ä»¬çš„<em> ViewController </em>çš„<em>è§†å›¾</em>ä¸å†ä»<em> UIView </em>ç»§æ‰¿ï¼Œè€Œæ˜¯ä»SwiftUIçš„<em>è§†å›¾ç»§æ‰¿ã€‚<br/> </em> <pre>struct WelcomeSceneView: View {     let viewModel: WelcomeSceneViewModel          var body: some View {         VStack {             Text(viewModel.text)             Divider()             Button(viewModel.buttonText) {                 viewModel.delegate?.didSelectButton(viewModel)             }         }     } } </pre></li>
</ul>
<p>å¦‚æœä»¥ä¸Šç‰‡æ®µè¿˜ä¸å¤Ÿï¼Œè¯·æŸ¥çœ‹æˆ‘çš„GitHubè´¦æˆ·ä¸­çš„ç¤ºä¾‹é¡¹ç›®<a href="http://web.archive.org/web/20221111121043/https://github.com/strzempa/CleanSwiftWithSwiftUI" rel="noopener" target="_blank">ã€‚</a></p>
<h2>Clean Swift + SwiftUIæ€»ç»“</h2>
<h4 id="Strengths-ğŸ’ª-:" data-renderer-start-pos="4845">å®ƒç»™é¡¹ç›®å¸¦æ¥äº†ä»€ä¹ˆï¼Ÿ</h4>
<ul>
<li>ç”¨éå¸¸é«˜çš„å¯æµ‹è¯•æ€§ã€å¯é‡ç”¨çš„ç»„ä»¶å®æ–½æ¨¡å—åŒ–ï¼Œå¹¶æå–ä¸šåŠ¡é€»è¾‘ã€‚</li>
<li><span>å¯åº”ç”¨äºä»»ä½•è§„æ¨¡å’Œå¹´é¾„çš„ç°æœ‰é¡¹ç›®ï¼Œç›®æ ‡éƒ¨ç½²åœ¨iOS 14ä»¥ä¸Šã€‚</span> <span/></li>
</ul>
<h4 id="Disadvantages-and-traps-ğŸ‘-:" data-renderer-start-pos="5481">å¸¦SwiftUIçš„Clean Swiftçš„ç¼ºç‚¹</h4>

<p>å¦‚æœæ‚¨åœ¨æœ¬æ–‡çš„ä»»ä½•åœ°æ–¹æ„Ÿåˆ°å›°æƒ‘ï¼Œå¯èƒ½æ˜¯å› ä¸ºæˆ‘å‡è®¾æ‚¨å·²ç»äº†è§£äº†ç”¨äºiOSå¼€å‘çš„Clean Swiftæ¶æ„è®¾è®¡æ¨¡å¼ã€‚å¦‚æœä½ ä¸çŸ¥é“ï¼Œæˆ–è€…åªæ˜¯æƒ³å›é¡¾ä¸€ä¸‹åŸºç¡€çŸ¥è¯†ï¼Œè¯·æŸ¥çœ‹<a href="/web/20221111121043/https://www.netguru.com/blog/clean-swift-ios-architecture-pattern#:~:text=Clean%20Swift%20(VIP)%20was%20first,in%20Uncle%20Bob'sClean%20Architecture." rel="noopener" target="_blank">æˆ‘ä¹‹å‰çš„åšå®¢Clean Swift (VIP) iOSæ¶æ„æ¨¡å¼ã€‚</a></p>
<p>æˆ‘çš„æƒ³æ³•åªæ˜¯ä¼—å¤šæƒ³æ³•ä¸­çš„ä¸€ä¸ªï¼Œå¾ˆéš¾è¯´æ··åˆUIKitå’ŒSwiftUIçš„æ–¹æ³•ä¼šåœ¨è¿™äº›å¹´é‡Œæœ‰ä»€ä¹ˆå˜åŒ–ã€‚æ‹¿ç€å®ƒï¼ŒæŒ‰ç…§ä½ çš„é¡¹ç›®éœ€è¦çš„æ–¹å¼ä¿®æ”¹å®ƒã€‚</p></span></div></div>    
</body>
</html>